import{o as d,c as i,w as u,v as c,a as t,t as A,n as $,u as V,r as m,b as W,d as M,e as I,F as k,f as w,g as C}from"./index-Dft5jy5g.js";import{a as h}from"./axios-C8DqakIB.js";const N="/vue-todolist/img2.png",R={id:"todo.id",class:"todoWrapper"},E=t("svg",{x:"0px",y:"0px",viewBox:"0 0 507.506 507.506",width:"20",height:"20"},[t("g",null,[t("path",{d:"M163.865,436.934c-14.406,0.006-28.222-5.72-38.4-15.915L9.369,304.966c-12.492-12.496-12.492-32.752,0-45.248l0,0   c12.496-12.492,32.752-12.492,45.248,0l109.248,109.248L452.889,79.942c12.496-12.492,32.752-12.492,45.248,0l0,0   c12.492,12.496,12.492,32.752,0,45.248L202.265,421.019C192.087,431.214,178.271,436.94,163.865,436.934z",fill:"#FFD370"})])],-1),G=[E],S={__name:"TodoComponent",props:["todo"],emits:"deleteTodo",setup(l,{emit:T}){const g=T;return(r,s)=>(d(),i("div",R,[u(t("button",{class:"donecheck",onClick:s[0]||(s[0]=a=>g("updateTodoStatus",l.todo.id))},G,512),[[c,l.todo.status===!0]]),u(t("button",{class:"checkbox",onClick:s[1]||(s[1]=a=>g("updateTodoStatus",l.todo.id))},null,512),[[c,l.todo.status===!1]]),t("p",{class:$({checktext:l.todo.status})},A(l.todo.content),3),t("button",{class:"deleteBtn",onClick:s[2]||(s[2]=a=>g("deleteTodo",l.todo.id))},"X")]))}},X=t("img",{src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/logo.png",alt:"logo"},null,-1),j={class:"navWrapper"},q={id:"mainTodoWrapper"},H={class:"textInput"},J={id:"todoWrapper"},K={class:"buttonGrp"},O={class:"todoSumText"},P={id:"noTodoUI",style:{"margin-top":"2rem",display:"flex","flex-direction":"column","align-items":"center"}},Q=t("h2",null,"目前暫無待辦事項",-1),Y=t("img",{src:N,alt:"no todo image"},null,-1),Z=[Q,Y],p="https://todolist-api.hexschool.io",et={__name:"TodoView",setup(l){const T=V(),g=document.cookie.replace(/(?:(?:^|.*;\s*)todoUser\s*=\s*([^;]*).*$)|^.*$/,"$1"),r=document.cookie.replace(/(?:(?:^|.*;\s*)todoToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),s=m("all"),a=m(""),v=m([]),D=m([]),y=m([]);function U(){D.value=v.value.filter(e=>e.status===!0),y.value=v.value.filter(e=>e.status===!1)}function z(e){var o=new Date;o.setDate(o.getDate()-1);var n=";expires="+o,F="";document.cookie=e+"="+F+n+"; path=/"}W(async()=>{const e=`${p}/users/checkout`;try{await h.get(e,{headers:{Authorization:r}}),f()}catch{alert("請先登入"),T.push("/login")}});async function B(){const e=`${p}/users/sign_out`;try{await h.post(e,{},{headers:{Authorization:r}}),z("todoToken"),z("todoUser"),alert("登出成功"),T.push("/login")}catch(o){console.log("登出失敗",o)}}function x(e){s.value=e}async function f(){const e=`${p}/todos/`;try{const o=await h.get(e,{headers:{Authorization:r}});v.value=o.data.data,U()}catch(o){console.log("拿todos失敗",o)}}async function L(){const e=`${p}/todos/`;if(a.value===""){alert("請輸入待辦事項");return}else try{await h.post(e,{content:a.value},{headers:{Authorization:r}}),alert("新增成功"),f(),a.value=""}catch(o){console.log("新增失敗",o)}}function _(e){const o=`${p}/todos/${e}`;try{h.delete(o,{headers:{Authorization:r}}),alert("待辦事項已刪除"),f()}catch(n){console.log("刪除失敗",n)}}function b(e){const o=`${p}/todos/${e}/toggle`;try{h.patch(o,null,{headers:{Authorization:r}}),alert("待辦事項狀態已更新"),f()}catch(n){console.log("toggle 失敗",n)}}return(e,o)=>(d(),i(k,null,[t("header",null,[t("nav",null,[X,t("div",j,[t("p",null,A(M(g))+"的待辦",1),t("button",{onClick:B},"登出")])])]),t("div",q,[t("div",H,[u(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":o[0]||(o[0]=n=>a.value=n)},null,512),[[I,a.value]]),t("button",{onClick:L},"+")]),u(t("div",J,[t("div",K,[t("button",{class:$({btnActive:s.value==="all"}),onClick:o[1]||(o[1]=n=>x("all"))},"全部",2),t("button",{class:$({btnActive:s.value==="yet"}),onClick:o[2]||(o[2]=n=>x("yet"))}," 待完成 ",2),t("button",{class:$({btnActive:s.value==="done"}),onClick:o[3]||(o[3]=n=>x("done"))}," 已完成 ",2)]),(d(!0),i(k,null,w(v.value,n=>u((d(),i("div",{id:"todos",key:n.id},[C(S,{onUpdateTodoStatus:b,todo:n,onDeleteTodo:_},null,8,["todo"])])),[[c,s.value==="all"]])),128)),(d(!0),i(k,null,w(y.value,n=>u((d(),i("div",{id:"todos",key:n.id},[C(S,{onUpdateTodoStatus:b,todo:n,onDeleteTodo:_},null,8,["todo"])])),[[c,s.value==="yet"]])),128)),(d(!0),i(k,null,w(D.value,n=>u((d(),i("div",{id:"todos",key:n.id},[C(S,{onUpdateTodoStatus:b,todo:n,onDeleteTodo:_},null,8,["todo"])])),[[c,s.value==="done"]])),128)),t("p",O,A(y.value.length)+" 個待完成項目",1)],512),[[c,v.value.length>0]]),u(t("div",P,Z,512),[[c,v.value.length===0]])])],64))}};export{et as default};
